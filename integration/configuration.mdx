---
title: 'Configuration Reference'
description: 'Complete reference for KoruAI configuration options and parameters'
icon: 'settings'
---

This page provides a comprehensive reference for all KoruAI configuration options, environment variables, and advanced settings.

## Configuration Object

The KoruAI middleware accepts a configuration object with the following parameters:

### Required Parameters

<ParamField path="apiKey" type="string" required>
  Your KoruAI API key for authentication with KoruAI servers.
  
  **Example:** `"koru_api_1234567890abcdef"`
  
  <Warning>Keep this secret and never expose it in client-side code.</Warning>
</ParamField>

<ParamField path="appId" type="string" required>
  Your application ID for identifying your app in the KoruAI system.
  
  **Example:** `"app_9876543210fedcba"`
</ParamField>

### Optional Parameters

<ParamField path="blockRealtime" type="boolean" default="false">
  Whether to check for anomalies in real-time and block suspicious requests.
  
  - `true`: Middleware will check for anomalies in real-time and block requests if anomalies are detected
  - `false`: Middleware will send request data to KoruAI servers for analysis and dashboard reporting only
  
  **Example:**
  ```javascript
  KoruAI({
    apiKey: process.env.KORUAI_API_KEY,
    appId: process.env.KORUAI_APP_ID,
    blockRealtime: true, // Enable real-time blocking
  })
  ```
</ParamField>

## Environment Variables

### Required Environment Variables

```bash
# Your KoruAI API key
KORUAI_API_KEY=your-api-key-here

# Your application ID
KORUAI_APP_ID=your-app-id-here
```

### Optional Environment Variables

```bash
# Environment-specific configuration
NODE_ENV=production

# Custom KoruAI server endpoint (for enterprise customers)
KORUAI_ENDPOINT=https://custom.koruai.com

# Debug logging (development only)
KORUAI_DEBUG=true
```

## Configuration Examples

### Basic Configuration

The minimal configuration required to get started:

```javascript
import KoruAI from "koruai";

app.use(KoruAI({
  apiKey: process.env.KORUAI_API_KEY,
  appId: process.env.KORUAI_APP_ID,
}));
```

### Production Configuration

Recommended configuration for production environments:

```javascript
import KoruAI from "koruai";

const koruaiConfig = {
  apiKey: process.env.KORUAI_API_KEY,
  appId: process.env.KORUAI_APP_ID,
  blockRealtime: true, // Enable real-time protection in production
};

// Validate configuration
if (!koruaiConfig.apiKey || !koruaiConfig.appId) {
  throw new Error('KoruAI configuration missing. Check environment variables.');
}

app.use(KoruAI(koruaiConfig));
```

### Environment-Specific Configuration

Different settings for different environments:

```javascript
import KoruAI from "koruai";

const getKoruAIConfig = () => {
  const baseConfig = {
    apiKey: process.env.KORUAI_API_KEY,
    appId: process.env.KORUAI_APP_ID,
  };

  switch (process.env.NODE_ENV) {
    case 'production':
      return {
        ...baseConfig,
        blockRealtime: true, // Block threats in production
      };
    
    case 'staging':
      return {
        ...baseConfig,
        blockRealtime: true, // Test blocking in staging
      };
    
    case 'development':
    default:
      return {
        ...baseConfig,
        blockRealtime: false, // Only monitor in development
      };
  }
};

app.use(KoruAI(getKoruAIConfig()));
```

### Conditional Integration

Enable KoruAI only when needed:

```javascript
import KoruAI from "koruai";

// Only use KoruAI in non-test environments
if (process.env.NODE_ENV !== 'test') {
  app.use(KoruAI({
    apiKey: process.env.KORUAI_API_KEY,
    appId: process.env.KORUAI_APP_ID,
    blockRealtime: process.env.NODE_ENV === 'production',
  }));
}
```

## Security Configuration

### API Key Management

<CardGroup cols={2}>
  <Card title="Development Keys" icon="code">
    Use separate API keys for development environments with limited permissions
  </Card>
  <Card title="Production Keys" icon="shield">
    Use production keys only in production with full security features enabled
  </Card>
</CardGroup>

### Key Rotation Strategy

```javascript
// config/koruai.js
const getKoruAIConfig = () => {
  // Support for key rotation
  const apiKey = process.env.KORUAI_API_KEY_NEW || process.env.KORUAI_API_KEY;
  
  if (!apiKey) {
    throw new Error('No KoruAI API key found');
  }

  return {
    apiKey,
    appId: process.env.KORUAI_APP_ID,
    blockRealtime: process.env.NODE_ENV === 'production',
  };
};

export default getKoruAIConfig;
```

## Real-time Blocking Configuration

### Understanding Real-time Blocking

When `blockRealtime` is enabled:

1. **Request Analysis**: Each request is analyzed against your custom AI-generated policies
2. **Instant Decision**: Anomalies are detected in real-time (< 1ms)
3. **Automatic Blocking**: Suspicious requests receive a 403 response
4. **Zero Latency**: Normal requests pass through with 0ms added latency

### Blocking Response Format

When a request is blocked, KoruAI returns:

```json
{
  "message": "Anomaly Detected."
}
```

**HTTP Status Code:** `403 Forbidden`

### Custom Blocking Responses

Currently, KoruAI uses a standard blocking response. For custom responses, you can implement additional middleware:

```javascript
app.use(KoruAI({
  apiKey: process.env.KORUAI_API_KEY,
  appId: process.env.KORUAI_APP_ID,
  blockRealtime: true,
}));

// Custom error handling for blocked requests
app.use((err, req, res, next) => {
  if (res.statusCode === 403) {
    return res.status(403).json({
      error: 'Request blocked by security policy',
      timestamp: new Date().toISOString(),
      requestId: req.headers['x-request-id'],
    });
  }
  next(err);
});
```

## Performance Configuration

### High Traffic Optimization

KoruAI is optimized for high-traffic applications:

```javascript
// No special configuration needed for high traffic
app.use(KoruAI({
  apiKey: process.env.KORUAI_API_KEY,
  appId: process.env.KORUAI_APP_ID,
  blockRealtime: true, // Even blocking has minimal performance impact
}));
```

### Memory Management

KoruAI automatically manages memory efficiently:

- **Minimal footprint**: < 1MB memory usage
- **No request queuing**: Asynchronous processing prevents memory buildup
- **Automatic cleanup**: Request data is processed and released immediately

## Monitoring and Debugging

### Debug Configuration

Enable detailed logging for troubleshooting:

```javascript
const koruaiConfig = {
  apiKey: process.env.KORUAI_API_KEY,
  appId: process.env.KORUAI_APP_ID,
  blockRealtime: process.env.NODE_ENV === 'production',
};

// Debug logging in development
if (process.env.NODE_ENV === 'development') {
  console.log('KoruAI initialized with config:', {
    apiKey: koruaiConfig.apiKey ? `${koruaiConfig.apiKey.slice(0, 8)}...` : 'missing',
    appId: koruaiConfig.appId ? `${koruaiConfig.appId.slice(0, 8)}...` : 'missing',
    blockRealtime: koruaiConfig.blockRealtime,
  });
}

app.use(KoruAI(koruaiConfig));
```

### Health Check Integration

Monitor KoruAI status in your health checks:

```javascript
app.get('/health', (req, res) => {
  const health = {
    status: 'healthy',
    timestamp: new Date().toISOString(),
    koruai: {
      configured: !!(process.env.KORUAI_API_KEY && process.env.KORUAI_APP_ID),
      blocking: process.env.NODE_ENV === 'production',
    },
  };
  
  res.json(health);
});
```

## Configuration Validation

### Runtime Validation

Validate your configuration at startup:

```javascript
const validateKoruAIConfig = (config) => {
  const errors = [];
  
  if (!config.apiKey) {
    errors.push('KORUAI_API_KEY is required');
  }
  
  if (!config.appId) {
    errors.push('KORUAI_APP_ID is required');
  }
  
  if (config.apiKey && !config.apiKey.startsWith('koru_')) {
    errors.push('Invalid API key format');
  }
  
  if (errors.length > 0) {
    throw new Error(`KoruAI configuration errors: ${errors.join(', ')}`);
  }
  
  return true;
};

const koruaiConfig = {
  apiKey: process.env.KORUAI_API_KEY,
  appId: process.env.KORUAI_APP_ID,
  blockRealtime: process.env.NODE_ENV === 'production',
};

validateKoruAIConfig(koruaiConfig);
app.use(KoruAI(koruaiConfig));
```

### TypeScript Configuration

For TypeScript projects, ensure proper typing:

```typescript
import KoruAI from "koruai";
import { KoruAIMiddlewareConfig } from "koruai/types";

const koruaiConfig: KoruAIMiddlewareConfig = {
  apiKey: process.env.KORUAI_API_KEY!,
  appId: process.env.KORUAI_APP_ID!,
  blockRealtime: process.env.NODE_ENV === 'production',
};

app.use(KoruAI(koruaiConfig));
```

## Best Practices

### Configuration Management

<AccordionGroup>
  <Accordion title="Use environment-specific configurations">
    Different environments should have different settings. Development should focus on monitoring, while production should enable real-time blocking.
  </Accordion>
  
  <Accordion title="Validate configuration at startup">
    Always validate your KoruAI configuration during application startup to catch issues early.
  </Accordion>
  
  <Accordion title="Implement graceful degradation">
    If KoruAI configuration is missing or invalid, decide whether to fail fast or continue without protection.
  </Accordion>
  
  <Accordion title="Monitor configuration changes">
    Log configuration changes and monitor for unexpected behavior after updates.
  </Accordion>
</AccordionGroup>

### Security Considerations

- **Never log API keys**: Ensure API keys are never written to logs or error messages
- **Use secure storage**: Store API keys in secure configuration management systems
- **Regular rotation**: Rotate API keys regularly and have a process for emergency rotation
- **Principle of least privilege**: Use different keys with appropriate permissions for different environments

## Troubleshooting

### Common Configuration Issues

<AccordionGroup>
  <Accordion title="Invalid API key format">
    **Error:** API key validation failed
    
    **Solution:** Ensure your API key starts with `koru_` and matches the format from your dashboard
  </Accordion>
  
  <Accordion title="Missing environment variables">
    **Error:** Configuration missing or undefined
    
    **Solution:** Check that `KORUAI_API_KEY` and `KORUAI_APP_ID` are set in your environment
  </Accordion>
  
  <Accordion title="Real-time blocking not working">
    **Error:** Requests not being blocked despite `blockRealtime: true`
    
    **Solution:** Ensure you have created policies in your dashboard and have sufficient training data
  </Accordion>
</AccordionGroup>

## Next Steps

<CardGroup cols={2}>
  <Card
    title="Integration Setup"
    icon="gear"
    href="/integration/setup"
  >
    Go back to the setup guide for implementation details
  </Card>
  <Card
    title="Quick Start Guide"
    icon="rocket"
    href="/quickstart"
  >
    Get started with KoruAI in 6 simple steps
  </Card>
</CardGroup>
